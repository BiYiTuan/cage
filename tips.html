<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Feb 15, 2011 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Cage - Captcha Generator - </title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20110215" />
    <meta http-equiv="Content-Language" content="en" />
                                                    
<meta content="cage, captcha, java, maven" name="keywords"/>
                                                        
<meta content="Cage is a CAPTCHA image generator java library. It is fast, small and simple. Its goal is to generate images that are easy to read for a human but impossible or at least very hard for a computer." name="description"/>
                                                        
<link rel="shortcut icon" href="s/i/icon32.ico"/>
                      
  </head>
  <body class="composite">
    <div id="banner">
                  <a href="index.html" id="bannerLeft">
                Cage - CAptcha GEnerator Java Library
                </a>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
        
                <div class="xleft">
        <span id="publishDate">Last Published: 2011-02-15</span>
                  &nbsp;| <span id="projectVersion">Version: 1.0-SNAPSHOT</span>
                      </div>
            <div class="xright">                    <a href="index.html" title="About">About</a>
            |
                        <a href="quickstart.html" title="QuickStart">QuickStart</a>
            |
                        <a href="templates.html" title="Templates">Templates</a>
            |
                        <a href="examples.html" title="Examples">Examples</a>
            |
                        <a href="tips.html" title="Tips for Captcha Usage">Tips for Captcha Usage</a>
            |
                        <a href="download.html" title="Download">Download</a>
            |
                        <a href="help_and_feedback.html" title="Help & Feedback">Help & Feedback</a>
            |
                        <a href="apidocs/index.html" title="Javadoc">Javadoc</a>
              
        
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
        
                                <h5>Overview</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="About">About</a>
            </li>
                  <li class="none">
                          <a href="quickstart.html" title="QuickStart">QuickStart</a>
            </li>
                  <li class="none">
                          <a href="templates.html" title="Templates">Templates</a>
            </li>
                                                                                                  <li class="expanded">
                          <a href="examples.html" title="Examples">Examples</a>
                    <ul>
                      <li class="none">
                          <a href="e01_simple.html" title="Simple">Simple</a>
            </li>
                      <li class="none">
                          <a href="e02_servlet.html" title="Servlet">Servlet</a>
            </li>
                      <li class="none">
                          <a href="e03_wicket.html" title="Wicket">Wicket</a>
            </li>
              </ul>
        </li>
                  <li class="none">
            <strong>Tips for Captcha Usage</strong>
          </li>
                  <li class="none">
                          <a href="download.html" title="Download">Download</a>
            </li>
                  <li class="none">
                          <a href="help_and_feedback.html" title="Help & Feedback">Help & Feedback</a>
            </li>
                  <li class="none">
                          <a href="apidocs/index.html" title="Javadoc">Javadoc</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                              <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                            <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
        
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Tips for Captcha Usage<a name="Tips_for_Captcha_Usage"></a></h2><p>Captcha gives the feeling of security but app integration errors could be made and those could enable the complete bypass of the captcha check.</p><p>These are some recommendations to keep in mind when implementing captcha on a web site.</p><div class="section"><h3>An ordinary request flow<a name="An_ordinary_request_flow"></a></h3><p>When an ordinary user (not an attacker) tries to use a captcha secured page the following requests take place:</p><ol style="list-style-type: decimal"><li>GET request for the html page, containing reference to captcha image</li><li>GET request for captcha image</li><li>POST of the form with the user provided captcha text. If the user input does not match the server side token back to 1. Otherwise the user passed the test.</li></ol><p>The server does the logic during these requests. An attacker can play with the requests and call them in different order or several times or just skip some of them.</p><p>Now let see what tasks the server has to do so the above flow can be safely fulfilled.</p></div><div class="section"><h3>Generate token<a name="Generate_token"></a></h3><p>Tokens should be generated during the 1. request and during the 3. request after validation (even if there was no error). This is important because if a new token is not generated when the validation fails the attacker can just retry against the same challenge. Also if the token is not regenerated (or invalidated) after a successful validation the attacker can repost automatically because the challenge remained the same and the solution for that is already known.</p></div><div class="section"><h3>Generate image<a name="Generate_image"></a></h3><p>This is done during the 2. request.</p><p>The token should only be used once to generate an image. Otherwise an attacker can ask for new images about the same token which makes automatic image recognition easier. So after render the token should be marked as used (but should not be invalidated because in that case there is no way to validate during the 3. request). If there is no token or it was already used sending an error (like 404) is a good solution.</p><p>Some could say why not generate the token and the image in the same 2. request? This can also be a good solution but some caution is needed this time too.</p><ul><li>Calling the 2. request more than once without a request to the 1. is not an ordinary flow. The server should detect and handle unordinary flows as fast as possible with the least resources. Generating a new image is not the fastest solution.</li><li>If the attacker skips the 2. request and does not post a user input in the 3. request the server can end up with null input and null token. If comparing the input and the token is done with something like Commons Lang's StringUtils.equals() or StringUtils.equalsIgnoreCase() this means that the attacker can simply bypass the captcha check. Make sure that the token is not null.</li><li>Still need to invalidate the token during the 3. request after validation (even when there was no error).</li></ul></div><div class="section"><h3>Tips to make the captcha more convenient for the web visitors<a name="Tips_to_make_the_captcha_more_convenient_for_the_web_visitors"></a></h3><ul><li>If the tokens include mixed case letters (like the &quot;Y&quot; template in Cage) ignore case when comparing it with the user input. Enforcing case sensitivity does not give to the security but it annoys the users.</li><li>If captcha is used on a login form it should not be visible on the first request. Only after the user made an error on the first try. This way most of the users will not ever see the captcha (and removes some load from the server because less dynamic image needs to be generated). This error counting should be based on the client IP and/or user name and not solely on the session. (This is used for example at GMail login screen.)</li><li>Give users an icon/link to ajax request a new captcha. Cage is trying to generate human readable images but sometimes it could be ambiguous to the user. In cases like this, if the user can ask for a new challenge without posting the form, the app will give a more pleasant user experience. (This is used for example at Yahoo registration screen.)</li></ul></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">Copyright &#169;                   2011.
          All Rights Reserved.      
        
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
